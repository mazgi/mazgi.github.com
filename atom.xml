<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[log++]]></title>
  <link href="http://mazgi.github.com/atom.xml" rel="self"/>
  <link href="http://mazgi.github.com/"/>
  <updated>2012-10-22T00:41:51+09:00</updated>
  <id>http://mazgi.github.com/</id>
  <author>
    <name><![CDATA[mazgi]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[jira_mysql_error]]></title>
    <link href="http://mazgi.github.com/blog/2012/10/15/jira-mysql-error/"/>
    <updated>2012-10-15T08:02:00+09:00</updated>
    <id>http://mazgi.github.com/blog/2012/10/15/jira-mysql-error</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[mazgi@bangdoll] $ grep binlog /etc/mysql/my.cnf
</span><span class='line'>[mazgi@bangdoll] $ mysql -uroot -p
</span><span class='line'>Enter password: 
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span><span class='line'>Your MySQL connection id is 46
</span><span class='line'>Server version: 5.1.62-log Gentoo Linux mysql-5.1.62-r1
</span><span class='line'>
</span><span class='line'>Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.
</span><span class='line'>
</span><span class='line'>Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.
</span><span class='line'>
</span><span class='line'>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
</span><span class='line'>
</span><span class='line'>mysql&gt; show variables like 'binlog_format';
</span><span class='line'>+---------------+-----------+
</span><span class='line'>| Variable_name | Value     |
</span><span class='line'>+---------------+-----------+
</span><span class='line'>| binlog_format | STATEMENT |
</span><span class='line'>+---------------+-----------+
</span><span class='line'>1 row in set (0.00 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; quit
</span><span class='line'>Bye</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # grep binlog /etc/mysql/my.cnf
</span><span class='line'>[root@bangdoll] # vi /etc/mysql/my.cnf
</span><span class='line'>[root@bangdoll] # grep binlog /etc/mysql/my.cnf
</span><span class='line'>binlog-format=ROW
</span><span class='line'>[root@bangdoll] # /etc/init.d/mysql restart
</span><span class='line'> * Stopping mysql ...                                                                                                                                                                                                                  [ ok ]
</span><span class='line'> * Starting mysql ...                                                                                                                                                                                                                  [ ok ]</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[mazgi@bangdoll] $ mysql -uroot -p
</span><span class='line'>Enter password: 
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span><span class='line'>Your MySQL connection id is 1
</span><span class='line'>Server version: 5.1.62-log Gentoo Linux mysql-5.1.62-r1
</span><span class='line'>
</span><span class='line'>Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.
</span><span class='line'>
</span><span class='line'>Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.
</span><span class='line'>
</span><span class='line'>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
</span><span class='line'>
</span><span class='line'>mysql&gt; show variables like 'binlog_format';
</span><span class='line'>+---------------+-------+
</span><span class='line'>| Variable_name | Value |
</span><span class='line'>+---------------+-------+
</span><span class='line'>| binlog_format | ROW   |
</span><span class='line'>+---------------+-------+
</span><span class='line'>1 row in set (0.01 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; quit
</span><span class='line'>Bye</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pythonbrew]]></title>
    <link href="http://mazgi.github.com/blog/2012/10/13/pythonbrew/"/>
    <updated>2012-10-13T15:49:00+09:00</updated>
    <id>http://mazgi.github.com/blog/2012/10/13/pythonbrew</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[mazgi@Caolila] $ curl -kL http://xrl.us/pythonbrewinstall | bash
</span><span class='line'>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span><span class='line'>                                 Dload  Upload   Total   Spent    Left  Speed
</span><span class='line'>100  2799  100  2799    0     0    824      0  0:00:03  0:00:03 --:--:--  1268
</span><span class='line'>Downloading http://pypi.python.org/packages/source/p/pythonbrew/pythonbrew-1.3.tar.gz
</span><span class='line'>######################################################################## 100.0%
</span><span class='line'>Extracting /Users/mazgi/.pythonbrew/dists/pythonbrew-1.3.tar.gz
</span><span class='line'>Installing pythonbrew into /Users/mazgi/.pythonbrew
</span><span class='line'>
</span><span class='line'>Well-done! Congratulations!
</span><span class='line'>
</span><span class='line'>The pythonbrew is installed as:
</span><span class='line'>    
</span><span class='line'>  /Users/mazgi/.pythonbrew
</span><span class='line'>
</span><span class='line'>Please add the following line to the end of your ~/.bashrc
</span><span class='line'>
</span><span class='line'>  [[ -s "$HOME/.pythonbrew/etc/bashrc" ]] && source "$HOME/.pythonbrew/etc/bashrc"
</span><span class='line'>
</span><span class='line'>After that, exit this shell, start a new one, and install some fresh
</span><span class='line'>pythons:
</span><span class='line'>
</span><span class='line'>  pythonbrew install 2.7.2
</span><span class='line'>  pythonbrew install 3.2
</span><span class='line'>
</span><span class='line'>For further instructions, run:
</span><span class='line'>
</span><span class='line'>  pythonbrew help
</span><span class='line'>
</span><span class='line'>The default help messages will popup and tell you what to do!
</span><span class='line'>
</span><span class='line'>Enjoy pythonbrew at /Users/mazgi/.pythonbrew!!</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[mazgi@Caolila] $ cat .zshenv
</span><span class='line'>[[ -s "$HOME/.pythonbrew/etc/bashrc" ]] && source "$HOME/.pythonbrew/etc/bashrc"</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[mazgi@Caolila] $ pythonbrew list -k
</span><span class='line'># Pythons
</span><span class='line'>Python-1.5.2
</span><span class='line'>Python-1.6.1
</span><span class='line'>Python-2.0.1
</span><span class='line'>Python-2.1.3
</span><span class='line'>Python-2.2.3
</span><span class='line'>Python-2.3.7
</span><span class='line'>Python-2.4.6
</span><span class='line'>Python-2.5.6
</span><span class='line'>Python-2.6.7
</span><span class='line'>Python-2.7.3
</span><span class='line'>Python-3.0.1
</span><span class='line'>Python-3.1.4
</span><span class='line'>Python-3.2.3
</span><span class='line'>[mazgi@Caolila] $ pythonbrew update
</span><span class='line'>You are already running the installed latest version of pythonbrew.
</span><span class='line'>[mazgi@Caolila] $ python --version
</span><span class='line'>Python 2.7.1
</span><span class='line'>[mazgi@Caolila] $ pythonbrew install 2.7.3
</span><span class='line'>Downloading Python-2.7.3.tgz as /Users/mazgi/.pythonbrew/dists/Python-2.7.3.tgz
</span><span class='line'>######################################################################## 100.0%
</span><span class='line'>Extracting Python-2.7.3.tgz into /Users/mazgi/.pythonbrew/build/Python-2.7.3
</span><span class='line'>
</span><span class='line'>This could take a while. You can run the following command on another shell to track the status:
</span><span class='line'>  tail -f "/Users/mazgi/.pythonbrew/log/build.log"
</span><span class='line'>
</span><span class='line'>Patching Python-2.7.3
</span><span class='line'>Installing Python-2.7.3 into /Users/mazgi/.pythonbrew/pythons/Python-2.7.3
</span><span class='line'>Downloading distribute_setup.py as /Users/mazgi/.pythonbrew/dists/distribute_setup.py
</span><span class='line'>######################################################################## 100.0%
</span><span class='line'>Installing distribute into /Users/mazgi/.pythonbrew/pythons/Python-2.7.3
</span><span class='line'>Installing pip into /Users/mazgi/.pythonbrew/pythons/Python-2.7.3
</span><span class='line'>
</span><span class='line'>Installed Python-2.7.3 successfully. Run the following command to switch to Python-2.7.3.
</span><span class='line'>  pythonbrew switch 2.7.3</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[mazgi@Caolila] $ python --version
</span><span class='line'>Python 2.7.1
</span><span class='line'>[mazgi@Caolila] $ pythonbrew use 2.7.3
</span><span class='line'>Using `Python-2.7.3`
</span><span class='line'>[mazgi@Caolila] $ python --version
</span><span class='line'>Python 2.7.3
</span><span class='line'>[mazgi@Caolila] $ zsh
</span><span class='line'>[mazgi@Caolila] $ python --version
</span><span class='line'>Python 2.7.1</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[さくらVPSにJIRAをインストールしてみました]]></title>
    <link href="http://mazgi.github.com/blog/2012/10/11/installing-jira/"/>
    <updated>2012-10-11T22:28:00+09:00</updated>
    <id>http://mazgi.github.com/blog/2012/10/11/installing-jira</id>
    <content type="html"><![CDATA[<p>自分用のJIRAがほしくなったので、体験版をさくらVPSに入れてみました。<br/>
x86_64なGentoo Linux+MySQLな環境にJIRAをインストールして、nginxのうしろで動かすまでのメモです。</p>

<p><img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_12.png"></p>

<h1>MySQLの設定</h1>

<p>今回はDBにMySQLを使います。<br/>
お仕事だと<a href="http://www.percona.com/software/percona-server">Percona Server with XtraDB</a>とか使ってるのですが、プライベートですし性能も必要ないので普通のMySQL5.1です。</p>

<h2>MySQLの設定確認</h2>

<p>バージョンとUSEフラグくらいをさっくり確認しておきます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # emerge -pv mysql
</span><span class='line'>
</span><span class='line'>These are the packages that would be merged, in order:
</span><span class='line'>
</span><span class='line'>Calculating dependencies... done!
</span><span class='line'>[ebuild   R    ] dev-db/mysql-5.1.62-r1  USE="berkdb community perl ssl -big-tables -cluster -debug -embedded -extraengine -latin1 -max-idx-128 -minimal -pbxt -profiling (-selinux) -static -test -xtradb" 0 kB
</span><span class='line'>
</span><span class='line'>Total: 1 package (1 reinstall), Size of downloads: 0 kB</span></code></pre></td></tr></table></div></figure>


<p>JIRA用のデータファイルは分けたいので<code>innodb_file_per_table</code>がセットされていることを確認します。<br/>
<code>datadir</code>のpathも確認しておきます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # grep innodb_file_per_table /etc/mysql/my.cnf
</span><span class='line'>innodb_file_per_table
</span><span class='line'>[root@bangdoll] # grep datadir /etc/mysql/my.cnf
</span><span class='line'>datadir                   = /var/lib/mysql</span></code></pre></td></tr></table></div></figure>


<h2>JIRA用LV作成</h2>

<p>筋が良い方法かは自信がないですが、JIRAのデータを1カ所に集めておきたいので専用にLVMのLV(<strong>L</strong><em>ogical</em><strong>V</strong><em>olume</em>)を作ってそこにセットアップすることにします。</p>

<p>JIRAという名前のLVを作ってXFSでフォーマットします。<br/>
XFSの場合、サイズは後からでもmountしたまま拡張できるので適当です。ただし、(unmountしても)縮小はできないのであまり大きくはしないようにします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # lvcreate -nJIRA -L4G VG00
</span><span class='line'>  Logical volume "JIRA" created
</span><span class='line'>[root@bangdoll] # mkfs.xfs /dev/VG00/JIRA
</span><span class='line'>…</span></code></pre></td></tr></table></div></figure>


<p>つくったLVは<code>/opt/JIRA</code>にマウントすることにします。<br/>
マウントポイントとなるディレクトリを作って<code>/etc/fstab</code>に行を追加します。<br/>
<code>mount -a</code>を実行してみて正しくマウントできることを確認します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # mkdir -p /opt/JIRA
</span><span class='line'>[root@bangdoll] # vi /etc/fstab
</span><span class='line'>[root@bangdoll] # grep /dev/VG00/JIRA /etc/fstab
</span><span class='line'>/dev/VG00/JIRA        /opt/JIRA   xfs     noatime     0 1
</span><span class='line'>[root@bangdoll] # mount -a
</span><span class='line'>[root@bangdoll] # mount | grep /opt/JIRA
</span><span class='line'>/dev/mapper/VG00-JIRA on /opt/JIRA type xfs (rw,noatime)</span></code></pre></td></tr></table></div></figure>


<h2>JIRA用データファイルの作成</h2>

<p>JIRA用のLVがマウントできたので、その中にデータファイルを作り配置します。</p>

<p>まずデータファイルディレクトリ(<code>/opt/JIRA/mysql</code>)を作ります。一緒にJIRAのインストールディレクトリ(<code>/opt/JIRA/jira_5.1.6</code>)も作りました。</p>

<p>次にMySQLのデータディレクトリである<code>/var/lib/mysql</code>に移動して、作ったJIRA用データファイルディレクトリのシンボリックリンクを張ります。
このシンボリックリンク名はMySQL上のデータベース名になります。</p>

<p>ここでちょっと問題が発生しました…。<br/>
MySQLのデータディレクトリにディレクトリ(シンボリックリンク含む)を作るとデータベースとして認識はされます。
しかし、<code>db.opt</code>ファイルがないため正常なデータベースとは見なされないようでテーブルを作ることもできません。</p>

<p>今回はムリヤリ<code>db.opt</code>ファイルを作ってしまったのですがなんかいい方法ないですかね。。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # mkdir -p /opt/JIRA/jira_5.1.6 /opt/JIRA/mysql
</span><span class='line'>[root@bangdoll] # cd /var/lib/mysql
</span><span class='line'>[root@bangdoll] # ln -s /opt/JIRA/mysql jira
</span><span class='line'>[root@bangdoll] # ls -l /var/lib/mysql/jira
</span><span class='line'>lrwxrwxrwx 1 root root 15 Oct 12 03:16 /var/lib/mysql/jira -&gt; /opt/JIRA/mysql/
</span><span class='line'>[root@bangdoll] # cat&lt;&lt;EOF&gt;jira/db.opt
</span><span class='line'>heredoc&gt; default-character-set=utf8
</span><span class='line'>heredoc&gt; default-collation=utf8_general_ci
</span><span class='line'>heredoc&gt; EOF
</span><span class='line'>[root@bangdoll] # chown -R mysql:mysql /opt/JIRA/mysql
</span><span class='line'>[root@bangdoll] # ls -ld /opt/JIRA/mysql
</span><span class='line'>drwxr-xr-x 2 mysql mysql 19 Oct 12 04:33 /opt/JIRA/mysql/
</span><span class='line'>[root@bangdoll] # ls -lR /opt/JIRA/mysql
</span><span class='line'>/opt/JIRA/mysql:
</span><span class='line'>total 4
</span><span class='line'>-rw-r--r-- 1 mysql mysql 61 Oct 12 04:30 db.opt</span></code></pre></td></tr></table></div></figure>


<p>ともあれJIRA用のデータベース(<code>jira</code>)ができたのでMySQLのシェルで確認してみます。</p>

<p>そしてJIRA用のMySQLユーザーとして<code>jira</code>を作り、<code>jira</code>データベースへの全権限を与えます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # mysql -uroot -p
</span><span class='line'>Enter password: 
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span><span class='line'>Your MySQL connection id is 7
</span><span class='line'>Server version: 5.1.62-log Gentoo Linux mysql-5.1.62-r1
</span><span class='line'>
</span><span class='line'>Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.
</span><span class='line'>
</span><span class='line'>Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.
</span><span class='line'>
</span><span class='line'>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
</span><span class='line'>
</span><span class='line'>mysql&gt; show databases;
</span><span class='line'>+--------------------+
</span><span class='line'>| Database           |
</span><span class='line'>+--------------------+
</span><span class='line'>| jira               |
</span><span class='line'>+--------------------+
</span><span class='line'>4 rows in set (0.02 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; grant all on jira.* to 'jira'@'localhost' identified by '********';
</span><span class='line'>Query OK, 0 rows affected (0.10 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; flush privileges;
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; quit
</span><span class='line'>Bye</span></code></pre></td></tr></table></div></figure>


<h1>JIRAインストール</h1>

<p>データの置き場所が決まったのでJIRA本体をインストールします。</p>

<h2>JIRAインストーラのダウンロード</h2>

<p>Linux用のインストーラをダウンロードします。<br/>
<a href="http://www.atlassian.com/software/jira/download">JIRAインストーラのダウンロードページ</a>はJIRAの開発元である<a href="http://www.atlassian.com/">Atlassian</a>のサイトにあります。<br/>
<em>Trial Download</em>と書かれていますが製品版との違いは登録するライセンスキーだけなので、製品版をインストールしたい場合でもインストーラ自体は同じものを使います。</p>

<p><img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_download_site.png"></p>

<p>今回は<code>curl</code>コマンドを使って<code>/tmp</code>にダウンロードします。<br/>
インストーラをダウンロードしたら実行可能属性を付けておきます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # cd /tmp
</span><span class='line'>[root@bangdoll] # curl -LO http://www.atlassian.com/software/jira/downloads/binary/atlassian-jira-5.1.6-x64.bin
</span><span class='line'>...
</span><span class='line'>[root@bangdoll] # ls -l atlassian-jira-5.1.6-x64.bin
</span><span class='line'>-rw-r--r-- 1 root  root  158706257 Oct 12 02:47 atlassian-jira-5.1.6-x64.bin
</span><span class='line'>[root@bangdoll] # chmod a+x atlassian-jira-5.1.6-x64.bin</span></code></pre></td></tr></table></div></figure>


<h3>ユーザーの作成(不要)</h3>

<p>インストーラが使ってくれることを期待して<code>jira</code>という名前のユーザーを作っておいたのですが…使ってくれませんでした。インストール前に作る意味はありません。<br/>
後述する実行ユーザー変更の伏線として残してあります。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # groupadd -g50000 jira
</span><span class='line'>[root@bangdoll] # useradd -u 50001 -g jira -s /bin/bash -d /opt/JIRA/home -m -c "Atlassian JIRA" jira
</span><span class='line'>[root@bangdoll] # grep jira /etc/passwd
</span><span class='line'>jira:x:50001:50000:Atlassian JIRA:/opt/JIRA/home:/bin/bash
</span><span class='line'>[root@bangdoll] # grep jira /etc/group
</span><span class='line'>jira:x:50000:
</span><span class='line'>[root@bangdoll] # ls -al /opt/JIRA/home
</span><span class='line'>total 12
</span><span class='line'>drwxr-xr-x 3 jira jira  70 Oct 12 03:33 ./
</span><span class='line'>drwxr-xr-x 5 root root  46 Oct 12 03:33 ../
</span><span class='line'>-rw-r--r-- 1 jira jira 551 Aug 21 03:27 .bashrc
</span><span class='line'>-rw-r--r-- 1 jira jira 127 Aug 21 03:27 .bash_logout
</span><span class='line'>-rw-r--r-- 1 jira jira 193 Aug 21 03:27 .bash_profile
</span><span class='line'>drwx------ 2 jira jira   6 Jun 21 21:09 .ssh/</span></code></pre></td></tr></table></div></figure>


<h2>JIRAインストーラの実行</h2>

<p>いよいよJIRA本体をインストールします。<br/>
インストーラを実行するとウィザード形式で質問してくるので答えるとインストールが完了します。今回は以下のように答えました。</p>

<ul>
<li><code>This will install JIRA 5.1.6 on your computer.</code><br/>
もちろんインストールするので<code>[o, Enter]</code>を選びます。</li>
<li><code>Choose the appropriate installation or upgrade option.</code><br/>
<code>Custom Install</code>したいので<code>2</code>を選びます。</li>
<li><code>Where should JIRA 5.1.6 be installed?</code><br/>
インストールディレクトリとして作った<code>/opt/JIRA/jira_5.1.6/jira</code>を入力します。</li>
<li><code>Default location for JIRA data</code><br/>
<code>/opt/JIRA/jira_5.1.6/application-data</code>を入力します。<br/>
インストールディレクトリと同じ階層に<code>application-data</code>というディレクトリ名でアプリケーションデータを置きます。</li>
<li><code>JIRA requires two TCP ports that are not being used by any other applications on this machine. …</code><br/>
JIRAはHTTPリクエスト用とコントロール用にTCPポートを2つ使うようです。ポート番号をカスタマイズしたいので<code>2</code>を選びます。

<ul>
<li><code>HTTP Port Number</code><br/>
50000番台をJIRAで使うことにして<code>50080</code>と入力します。</li>
<li><code>Control Port Number</code><br/>
<code>50005</code>と入力します。</li>
</ul>
</li>
<li><code>You may choose to run JIRA as a service, which means it will start automatically whenever the computer restarts.</code><br/>
サービスとしてインストールしたいので<code>y</code>を入力します。</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # cd /tmp
</span><span class='line'>[root@bangdoll] # ls -l atlassian-jira-5.1.6-x64.bin
</span><span class='line'>-rwxr-xr-x 1 root root 158706257 Oct 12 02:47 atlassian-jira-5.1.6-x64.bin*
</span><span class='line'>[root@bangdoll] # ./atlassian-jira-5.1.6-x64.bin
</span><span class='line'>Unpacking JRE ...
</span><span class='line'>Starting Installer ...
</span><span class='line'>
</span><span class='line'>This will install JIRA 5.1.6 on your computer.
</span><span class='line'>OK [o, Enter], Cancel [c]
</span><span class='line'>o
</span><span class='line'>Choose the appropriate installation or upgrade option.
</span><span class='line'>Please choose one of the following:
</span><span class='line'>Express Install (use default settings) [1], Custom Install (recommended for advanced users) [2], Upgrade an existing JIRA installation [3, Enter]
</span><span class='line'>2
</span><span class='line'>
</span><span class='line'>Where should JIRA 5.1.6 be installed?
</span><span class='line'>[/opt/atlassian/jira]
</span><span class='line'>/opt/JIRA/jira_5.1.6/jira
</span><span class='line'>Default location for JIRA data
</span><span class='line'>[/var/atlassian/application-data/jira]
</span><span class='line'>/opt/JIRA/jira_5.1.6/application-data
</span><span class='line'>Configure which ports JIRA will use.
</span><span class='line'>JIRA requires two TCP ports that are not being used by any other
</span><span class='line'>applications on this machine. The HTTP port is where you will access JIRA
</span><span class='line'>through your browser. The Control port is used to Startup and Shutdown JIRA.
</span><span class='line'>Use default ports (HTTP: 8080, Control: 8005) - Recommended [1, Enter], Set custom value for HTTP and Control ports [2]
</span><span class='line'>2
</span><span class='line'>HTTP Port Number
</span><span class='line'>[8080]
</span><span class='line'>50080
</span><span class='line'>Control Port Number
</span><span class='line'>[8005]
</span><span class='line'>50005
</span><span class='line'>JIRA can be run in the background.
</span><span class='line'>You may choose to run JIRA as a service, which means it will start
</span><span class='line'>automatically whenever the computer restarts.
</span><span class='line'>Install JIRA as Service?
</span><span class='line'>Yes [y, Enter], No [n]
</span><span class='line'>y
</span><span class='line'>
</span><span class='line'>Extracting files ...
</span><span class='line'>                                                                           
</span><span class='line'>
</span><span class='line'>Please wait a few moments while JIRA starts up.
</span><span class='line'>Launching JIRA ...
</span><span class='line'>Installation of JIRA 5.1.6 is complete
</span><span class='line'>Your installation of JIRA 5.1.6 is now ready and can be accessed via your
</span><span class='line'>browser.
</span><span class='line'>JIRA 5.1.6 can be accessed at http://localhost:50080
</span><span class='line'>Finishing installation ...</span></code></pre></td></tr></table></div></figure>


<p>以上でJIRAがサービスとして起動します。</p>

<h3>JIRA実行ユーザーの確認</h3>

<p>さて問題のユーザーです。<br/>
てっきり作った<code>jira</code>ユーザーを使ってくれるものと期待したのですが…<br/>
なんということでしょう！…<code>jira1</code>ユーザーを作られてしまいました。しっかり<code>jira1</code>ユーザーで実行されています…oh。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # grep jira /etc/passwd
</span><span class='line'>jira:x:50001:50000:Atlassian JIRA:/opt/JIRA/home:/bin/bash
</span><span class='line'>jira1:x:50002:50002:Atlassian JIRA:/home/jira1:/bin/bash
</span><span class='line'>[root@bangdoll] # grep jira /etc/group
</span><span class='line'>jira:x:50000:
</span><span class='line'>jira1:x:50002:
</span><span class='line'>[root@bangdoll] # ps aux | grep jir\[a\]
</span><span class='line'>jira1     7536  8.2 16.1 2691288 332336 pts/1  Sl   03:37   0:52 /opt/JIRA/jira_5.1.6/jira/jre//bin/java -Djava.util.logging.config.file=/opt/JIRA/jira_5.1.6/jira/conf/logging.properties -XX:MaxPermSize=256m -Xms256m -Xmx768m -Djava.awt.headless=true -Datlassian.standalone=JIRA -Dorg.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true -Dmail.mime.decodeparameters=true -XX:+PrintGCDateStamps -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/opt/JIRA/jira_5.1.6/jira/endorsed -classpath /opt/JIRA/jira_5.1.6/jira/bin/bootstrap.jar -Dcatalina.base=/opt/JIRA/jira_5.1.6/jira -Dcatalina.home=/opt/JIRA/jira_5.1.6/jira -Djava.io.tmpdir=/opt/JIRA/jira_5.1.6/jira/temp org.apache.catalina.startup.Bootstrap start</span></code></pre></td></tr></table></div></figure>


<p>どうにかして<code>jira</code>ユーザーで動いてほしいところです。</p>

<h2>JIRA実行ユーザーを変える</h2>

<p>JIRAを<code>jira</code>ユーザーで動かして微妙なsuffixが付いた<code>jira1</code>ユーザーを消したいのでJIRAの実行ユーザーを変えてみます。</p>

<p>まずはJIRAを止めます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # /etc/init.d/jira1 stop
</span><span class='line'>executing using dedicated user
</span><span class='line'>                .....
</span><span class='line'>          .... .NMMMD.  ...
</span><span class='line'>        .8MMM.  $MMN,..~MMMO.
</span><span class='line'>        .?MMM.         .MMM?.
</span><span class='line'>
</span><span class='line'>     OMMMMZ.           .,NMMMN~
</span><span class='line'>     .IMMMMMM. .NMMMN. .MMMMMN,
</span><span class='line'>       ,MMMMMM$..3MD..ZMMMMMM.
</span><span class='line'>        =NMMMMMM,. .,MMMMMMD.
</span><span class='line'>         .MMMMMMMM8MMMMMMM,
</span><span class='line'>           .ONMMMMMMMMMMZ.
</span><span class='line'>             ,NMMMMMMM8.
</span><span class='line'>            .:,.$MMMMMMM
</span><span class='line'>          .IMMMM..NMMMMMD.
</span><span class='line'>         .8MMMMM:  :NMMMMN.
</span><span class='line'>         .MMMMMM.   .MMMMM~.
</span><span class='line'>         .MMMMMN    .MMMMM?.
</span><span class='line'>
</span><span class='line'>      Atlassian JIRA
</span><span class='line'>      Version : 5.1.6
</span><span class='line'>                  
</span><span class='line'>Detecting JVM PermGen support...
</span><span class='line'>PermGen switch is supported. Setting to 256m
</span><span class='line'>
</span><span class='line'>If you encounter issues starting or stopping JIRA, please see the Troubleshooting guide at http://confluence.atlassian.com/display/JIRA/Installation+Troubleshooting+Guide
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Server startup logs are located in /opt/JIRA/jira_5.1.6/jira/logs/catalina.out
</span><span class='line'>Using CATALINA_BASE:   /opt/JIRA/jira_5.1.6/jira
</span><span class='line'>Using CATALINA_HOME:   /opt/JIRA/jira_5.1.6/jira
</span><span class='line'>Using CATALINA_TMPDIR: /opt/JIRA/jira_5.1.6/jira/temp
</span><span class='line'>Using JRE_HOME:        /opt/JIRA/jira_5.1.6/jira/jre/
</span><span class='line'>Using CLASSPATH:       /opt/JIRA/jira_5.1.6/jira/bin/bootstrap.jar
</span><span class='line'>Using CATALINA_PID:    /opt/JIRA/jira_5.1.6/jira/work/catalina.pid</span></code></pre></td></tr></table></div></figure>


<p>起動スクリプトの名前を変えます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # mv /etc/init.d/jira1 /etc/init.d/jira</span></code></pre></td></tr></table></div></figure>


<p>インストールディレクトリのownerを確認してみます。ファイル/ディレクトリのownerが<code>root</code>なものと<code>jira1</code>なものがあるようです。<br/>
ownerが<code>jira1</code>ユーザーであるファイル/ディレクトリのownerを<code>jira</code>ユーザーに変更していきます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # cd /opt/JIRA/jira_5.1.6
</span><span class='line'>[root@bangdoll] # ls -l
</span><span class='line'>total 4
</span><span class='line'>drwx------  9 jira1 root   90 Oct 12 03:49 application-data/
</span><span class='line'>drwxr-xr-x 15 root  root 4096 Oct 12 03:37 jira/
</span><span class='line'>[root@bangdoll] # ls -l jira
</span><span class='line'>total 100
</span><span class='line'>-rw-r--r--  1 root  root   574 Sep 25 10:12 NOTICE
</span><span class='line'>-rw-r--r--  1 root  root  3749 Sep 25 10:12 README.html
</span><span class='line'>-rw-r--r--  1 root  root  2043 Sep 25 10:12 README.txt
</span><span class='line'>drwxr-xr-x 16 root  root  4096 Oct 12 03:37 atlassian-jira/
</span><span class='line'>drwxr-xr-x  2 root  root  4096 Oct 12 03:45 bin/
</span><span class='line'>drwxr-xr-x  2 root  root   151 Oct 12 03:37 conf/
</span><span class='line'>drwxr-xr-x  2 root  root    39 Oct 12 03:37 external-source/
</span><span class='line'>-rw-r--r--  1 root  root 54642 Oct 12 03:37 install.reg
</span><span class='line'>drwxr-xr-x  7 root  root  4096 Oct 12 03:36 jre/
</span><span class='line'>drwxr-xr-x  2 root  root  4096 Oct 12 03:37 lib/
</span><span class='line'>drwxr-xr-x  2 root  root    24 Oct 12 03:37 licenses/
</span><span class='line'>drwx------  2 jira1 root  4096 Oct 12 03:37 logs/
</span><span class='line'>drwx------  2 jira1 root    46 Oct 12 03:37 temp/
</span><span class='line'>drwxr-xr-x  2 root  root    58 Oct 12 03:37 tomcat-docs/
</span><span class='line'>-rwx------  1 root  root 11200 Sep 25 10:15 uninstall*
</span><span class='line'>drwxr-xr-x  2 root  root     6 Sep 25 10:15 webapps/
</span><span class='line'>drwx------  3 jira1 root    21 Oct 12 03:49 work/</span></code></pre></td></tr></table></div></figure>


<p>まずは<code>application-data</code>のownerを<code>jira</code>ユーザー:<code>jira</code>グループに変更します。<br/>
元はgroupが<code>root</code>ですが<code>jira</code>グループに変えてしまって問題なさそうです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # chown -R jira:jira application-data
</span><span class='line'>[root@bangdoll] # ls -l
</span><span class='line'>total 4
</span><span class='line'>drwx------  9 jira jira   90 Oct 12 03:49 application-data/
</span><span class='line'>drwxr-xr-x 15 root root 4096 Oct 12 03:37 jira/</span></code></pre></td></tr></table></div></figure>


<p>続いて<code>jira/logs</code>, <code>jira/temp</code>, <code>jira/work</code>の3ディレクトリのownerを<code>jira</code>ユーザー:<code>jira</code>グループに変えます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # chown -R jira:jira jira/logs jira/temp jira/work
</span><span class='line'>[root@bangdoll] # ls -l jira
</span><span class='line'>total 100
</span><span class='line'>-rw-r--r--  1 root root   574 Sep 25 10:12 NOTICE
</span><span class='line'>-rw-r--r--  1 root root  3749 Sep 25 10:12 README.html
</span><span class='line'>-rw-r--r--  1 root root  2043 Sep 25 10:12 README.txt
</span><span class='line'>drwxr-xr-x 16 root root  4096 Oct 12 03:37 atlassian-jira/
</span><span class='line'>drwxr-xr-x  2 root root  4096 Oct 12 03:45 bin/
</span><span class='line'>drwxr-xr-x  2 root root   151 Oct 12 03:37 conf/
</span><span class='line'>drwxr-xr-x  2 root root    39 Oct 12 03:37 external-source/
</span><span class='line'>-rw-r--r--  1 root root 54642 Oct 12 03:37 install.reg
</span><span class='line'>drwxr-xr-x  7 root root  4096 Oct 12 03:36 jre/
</span><span class='line'>drwxr-xr-x  2 root root  4096 Oct 12 03:37 lib/
</span><span class='line'>drwxr-xr-x  2 root root    24 Oct 12 03:37 licenses/
</span><span class='line'>drwx------  2 jira jira  4096 Oct 12 03:37 logs/
</span><span class='line'>drwx------  2 jira jira    46 Oct 12 03:37 temp/
</span><span class='line'>drwxr-xr-x  2 root root    58 Oct 12 03:37 tomcat-docs/
</span><span class='line'>-rwx------  1 root root 11200 Sep 25 10:15 uninstall*
</span><span class='line'>drwxr-xr-x  2 root root     6 Sep 25 10:15 webapps/
</span><span class='line'>drwx------  3 jira jira    21 Oct 12 03:49 work/</span></code></pre></td></tr></table></div></figure>


<p>JIRAの実行ユーザー名が書かれている<code>user.sh</code>を編集します。<br/>
どうやらJIRAの実行ユーザーは<code>JIRA_USER</code>という環境変数で設定されているようです。<em>INSTALLER MAGIC ! DO NOT EDIT !</em>だそうですが気にしないことにします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # cat jira/bin/user.sh
</span><span class='line'># START INSTALLER MAGIC ! DO NOT EDIT !
</span><span class='line'>JIRA_USER="jira1" # user created by installer
</span><span class='line'># END INSTALLER MAGIC ! DO NOT EDIT !
</span><span class='line'>
</span><span class='line'>export JIRA_USER
</span><span class='line'>[root@bangdoll] # vi jira/bin/user.sh
</span><span class='line'>[root@bangdoll] # cat jira/bin/user.sh
</span><span class='line'># START INSTALLER MAGIC ! DO NOT EDIT !
</span><span class='line'>JIRA_USER="jira" # user created by installer
</span><span class='line'># END INSTALLER MAGIC ! DO NOT EDIT !
</span><span class='line'>
</span><span class='line'>export JIRA_USER</span></code></pre></td></tr></table></div></figure>


<p>JIRAを起動してみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # /etc/init.d/jira start
</span><span class='line'>
</span><span class='line'>To run JIRA in the foreground, start the server with start-jira.sh -fg
</span><span class='line'>executing using dedicated user: jira
</span><span class='line'>                .....
</span><span class='line'>          .... .NMMMD.  ...
</span><span class='line'>        .8MMM.  $MMN,..~MMMO.
</span><span class='line'>        .?MMM.         .MMM?.
</span><span class='line'>
</span><span class='line'>     OMMMMZ.           .,NMMMN~
</span><span class='line'>     .IMMMMMM. .NMMMN. .MMMMMN,
</span><span class='line'>       ,MMMMMM$..3MD..ZMMMMMM.
</span><span class='line'>        =NMMMMMM,. .,MMMMMMD.
</span><span class='line'>         .MMMMMMMM8MMMMMMM,
</span><span class='line'>           .ONMMMMMMMMMMZ.
</span><span class='line'>             ,NMMMMMMM8.
</span><span class='line'>            .:,.$MMMMMMM
</span><span class='line'>          .IMMMM..NMMMMMD.
</span><span class='line'>         .8MMMMM:  :NMMMMN.
</span><span class='line'>         .MMMMMM.   .MMMMM~.
</span><span class='line'>         .MMMMMN    .MMMMM?.
</span><span class='line'>
</span><span class='line'>      Atlassian JIRA
</span><span class='line'>      Version : 5.1.6
</span><span class='line'>                  
</span><span class='line'>Detecting JVM PermGen support...
</span><span class='line'>PermGen switch is supported. Setting to 256m
</span><span class='line'>
</span><span class='line'>If you encounter issues starting or stopping JIRA, please see the Troubleshooting guide at http://confluence.atlassian.com/display/JIRA/Installation+Troubleshooting+Guide
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Server startup logs are located in /opt/JIRA/jira_5.1.6/jira/logs/catalina.out
</span><span class='line'>Using CATALINA_BASE:   /opt/JIRA/jira_5.1.6/jira
</span><span class='line'>Using CATALINA_HOME:   /opt/JIRA/jira_5.1.6/jira
</span><span class='line'>Using CATALINA_TMPDIR: /opt/JIRA/jira_5.1.6/jira/temp
</span><span class='line'>Using JRE_HOME:        /opt/JIRA/jira_5.1.6/jira/jre/
</span><span class='line'>Using CLASSPATH:       /opt/JIRA/jira_5.1.6/jira/bin/bootstrap.jar
</span><span class='line'>Using CATALINA_PID:    /opt/JIRA/jira_5.1.6/jira/work/catalina.pid
</span><span class='line'>[root@bangdoll] # ps aux | grep jir\[a\]
</span><span class='line'>jira      7849  136 15.8 2690072 325976 pts/1  Sl   03:59   0:31 /opt/JIRA/jira_5.1.6/jira/jre//bin/java -Djava.util.logging.config.file=/opt/JIRA/jira_5.1.6/jira/conf/logging.properties -XX:MaxPermSize=256m -Xms256m -Xmx768m -Djava.awt.headless=true -Datlassian.standalone=JIRA -Dorg.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true -Dmail.mime.decodeparameters=true -XX:+PrintGCDateStamps -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/opt/JIRA/jira_5.1.6/jira/endorsed -classpath /opt/JIRA/jira_5.1.6/jira/bin/bootstrap.jar -Dcatalina.base=/opt/JIRA/jira_5.1.6/jira -Dcatalina.home=/opt/JIRA/jira_5.1.6/jira -Djava.io.tmpdir=/opt/JIRA/jira_5.1.6/jira/temp org.apache.catalina.startup.Bootstrap start</span></code></pre></td></tr></table></div></figure>


<p>無事<code>jira</code>ユーザーで起動しました！</p>

<p>最後に<code>jira1</code>ユーザーと<code>jira1</code>グループを消しておきます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # userdel -r jira1
</span><span class='line'>userdel: jira1 home directory (/home/jira1) not found
</span><span class='line'>[root@bangdoll] # groupdel jira1
</span><span class='line'>groupdel: group 'jira1' does not exist</span></code></pre></td></tr></table></div></figure>


<h1>nginxの設定</h1>

<p>HTTPサーバーとしてnginxを使っているので、JIRAもnginx経由でアクセスするように設定します。<br/>
またJIRAのHTTPポートである50080番はiptablesでdropします。</p>

<p>JIRAをホストするnginxですが、<code>/etc/nginx/sites.enabled</code>以下の設定ファイルをincludeする設定になっています。
また<code>/etc/nginx/sites.enabled/*</code>は<code>/etc/nginx/sites.availables</code>以下の設定ファイルのうち、公開したいもののみシンボリックリンクを張っています。</p>

<p>JIRAサイト用の設定ファイルを<code>jira.mazgi.com</code>という名前で作ります。<br/>
設定内容はおおむね以下です。</p>

<ul>
<li><code>upstream</code>ディレクティブの設定内容

<ul>
<li>自ホストの50080番をbackendにします。</li>
</ul>
</li>
<li><code>server</code>ディレクティブの設定内容

<ul>
<li>Hostヘッダが<code>jira.mazgi.com</code>のリクエストをJIRAに転送します。</li>
<li><code>access_log</code>と<code>error_log</code>はそれぞれ専用のディレクトリに出力します。</li>
<li>JIRAに転送される際、Hostヘッダに<code>$http_host</code>がセットされるようにします。</li>
<li><code>jira.mazgi.com</code>のすべてのpathへのリクエストをbackendに転送します。</li>
</ul>
</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # cd /etc/nginx/sites.availables
</span><span class='line'>[root@bangdoll] # vi jira.mazgi.com
</span><span class='line'>[root@bangdoll] # cat jira.mazgi.com
</span><span class='line'>upstream jira.mazgi.com.backend {
</span><span class='line'>  server 127.0.0.1:50080;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>server {
</span><span class='line'>  listen 0.0.0.0:80;
</span><span class='line'>  server_name jira.mazgi.com;
</span><span class='line'>
</span><span class='line'>  access_log /var/log/nginx/jira.mazgi.com/access_log main;
</span><span class='line'>  error_log /var/log/nginx/jira.mazgi.com/error_log info;
</span><span class='line'>
</span><span class='line'>  proxy_set_header Host $http_host;
</span><span class='line'>
</span><span class='line'>  location / {
</span><span class='line'>      proxy_pass http://jira.mazgi.com.backend;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ログ出力先のディレクトリを作ります。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # mkdir -p /var/log/nginx/jira.mazgi.com</span></code></pre></td></tr></table></div></figure>


<p>JIRAサイトを公開するために<code>sites.availables</code>から<code>sites.enabled</code>にシンボリックリンクを張り、nginxをrestartします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@bangdoll] # cd /etc/nginx/sites.enabled
</span><span class='line'>[root@bangdoll] # ln -s ../sites.availables/jira.mazgi.com .
</span><span class='line'>[root@bangdoll] # ls -l jira.mazgi.com
</span><span class='line'>lrwxrwxrwx 1 root root 34 Oct 12 04:10 jira.mazgi.com -&gt; ../sites.availables/jira.mazgi.com
</span><span class='line'>[root@bangdoll] # /etc/init.d/nginx restart
</span><span class='line'> * Checking nginx' configuration ...                                                                                                                                                                                                                                                                                   [ ok ]
</span><span class='line'> * Stopping nginx ...                                                                                                                                                                                                                                                                                                  [ ok ]
</span><span class='line'> * Starting nginx ...                                                                                                                                                                                                                                                                                                  [ ok ]</span></code></pre></td></tr></table></div></figure>


<p>nginxをrestartするとこのように<code>http://jira.mazgi.com:80</code>でJIRAに接続できるようになりました！</p>

<p><img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_01.png"></p>

<h1>JIRAの設定</h1>

<p>Web上でJIRAの設定を行います。<br/>
先立って<a href="https://my.atlassian.com/signup/index">Atlassianのユーザー登録ページ</a>でユーザー登録し、ログインしておくことをおすすめします。</p>

<p>言語は英語に設定しました。<br/>
DBはMySQLを使うので<em>External</em>を選択し、MySQLサーバーの接続ポートやJIRA用MySQLユーザー名を入力します。<br/>
<em>Test Connection</em>ボタンを押すとDB接続を確認できます。<br/>
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_02.png"></p>

<p><em>Application Title</em>を適当に設定します。<br/>
JIRAのユーザー作成を自分でコントロールしたいので、<em>Mode</em>は<em>Private</em>にします。<br/>
Atlassianにログインした状態で<em>Generate an evaluation key for me</em>をクリックすると評価ライセンスの発行ページに飛べます。<br/>
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_03.png">
<em>ライセンスの生成</em>ボタンをクリックすると評価ライセンスが作られます。<br/>
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_05.png">
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_06.png">
なぜか<em>Application Title</em>が消えたりしますが、再度入力して<em>Next</em>ボタンを押します。<br/>
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_08.png">
管理アカウントのユーザー名やパスワードを入力します。<br/>
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_09.png">
メールの設定はあとで行うことにします。<br/>
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_10.png">
以上でJIRAの設定が完了しました！
<img src="http://mazgi.github.com/images/2012-10-11-installing-jira/20121011_setup_11.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「第0回Debianパッケージング道場」に行ってきました]]></title>
    <link href="http://mazgi.github.com/blog/2012/09/22/debian-dojo/"/>
    <updated>2012-09-22T16:54:00+09:00</updated>
    <id>http://mazgi.github.com/blog/2012/09/22/debian-dojo</id>
    <content type="html"><![CDATA[<p>9/22(土)に楽天さんで<a href="http://www.zusaar.com/event/355109">第0回Debianパッケージング道場 on Zusaar</a>が開催されたので行ってきました。<br/>
Debianド素人として大いにハマってきた様をレポートしてみます。</p>

<h1>参加するまで</h1>

<h2>参加の動機とか</h2>

<p>最近仕事でDebian GNU/Linuxを触りはじめたので「社内用に最新バージョンやpatch適用済みのパッケージ作れたらな」という軽い気持ちです。
DebianにはRuby1.9.3のパッケージがなさそうだった <em>(※<a href="http://packages.debian.org/ja/sid/libruby">libruby</a>というパッケージがあるようです)</em> ので、「ちょっとパッケージ作ってみるか」とか考えてました。</p>

<h2>準備したこと</h2>

<p>前日になってバタバタとMacBook Air上のVirtualBoxにDebian GNU/Linuxをインストールしました。</p>

<ul>
<li>Debian squeezeインストール</li>
</ul>


<p><img src="http://mazgi.github.com/images/2012-09-22-debian-dojo/20120922_debian_squeeze_installed.png"></p>

<p><em>&#8220;使うパソコンで Debian / unstable が動作する環境を整えてください。&#8221;</em> とのことだったので、VirtualBoxに <strong>Debian squeeze</strong> をインストールしました <em>(※後述、unstableが何たるかを理解していませんでした)</em> 。<br/>
インストール自体はISOイメージファイルから普通に行いました。パーティションを手動で切ったくらいなので手順は省きます。</p>

<ul>
<li>sshd設定</li>
</ul>


<p>Macから <code>ssh xxx.local</code> したかったので <strong>SSHデーモン</strong> と <strong>Avahi</strong> を入れました。<br/>
sshdのパッケージ名、sshなんですね。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install avahi-daemon
</span><span class='line'># apt-get install ssh</span></code></pre></td></tr></table></div></figure>


<ul>
<li>開発ツールインストール</li>
</ul>


<p><em>&#8220;Debian / unstable に 最低限のビルド環境を構築してください。sudo apt-get install packaging-dev&#8221;</em> とのことだったので <code>packaging-dev</code> をインストールしようとしたのですが…</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install packaging-dev
</span><span class='line'>パッケージリストを読み込んでいます... 完了
</span><span class='line'>依存関係ツリーを作成しています                
</span><span class='line'>状態情報を読み取っています... 完了
</span><span class='line'>E: パッケージ packaging-dev が見つかりません</span></code></pre></td></tr></table></div></figure>


<p>…なぜかパッケージが見つかりません <em>(※後述)</em> 。<br/>
仕方ないので保留して <code>build-essential</code> だけ入れておきました。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install build-essential</span></code></pre></td></tr></table></div></figure>


<h1>当日</h1>

<p>当日は、午前中ハンズオン、午後から黙々とハッカソンっぽい感じで進みました。<br/>
ハンズオン形式で <a href="https://twitter.com/iwamatsu">@iwamatsu</a> 先生が用意してくださったサンプルをDebianパッケージにしていきます。</p>

<h3>ネットワーク</h3>

<p>VirtualBoxのネットワーク設定をブリッジにしていたのですが、IPアドレスがもらえませんでした(ありがち)。<br/>
慌てて仮想NICを追加！</p>

<p><img src="http://mazgi.github.com/images/2012-09-22-debian-dojo/20120922_add_virtual_nic.png"></p>

<h2>作業をはじめる前の準備</h2>

<ul>
<li>パッケージメンテナ名の設定</li>
</ul>


<p>パッケージメンテナの名前 <code>DEBFULLNAME</code> と メールアドレス <code>DEBEMAIL</code> を環境変数として設定しましょうとのこと。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>￼export DEBFULLNAME="Yasuo IWAKURA"
</span><span class='line'>export DEBEMAIL="Y.I@wired.example.com"</span></code></pre></td></tr></table></div></figure>


<p>本来は <code>∼/.bashrc</code> などに書くようです。<br/>
私はネットワークの設定しててこれをすっとばしたのであとでちょっと悩むことになります  <em>(※後述)</em> 。</p>

<ul>
<li><code>packaging-dev</code> のインストール</li>
</ul>


<p>これはメタパッケージで、インストールDebianパッケージをパッケージングするのに必要な各種パッケージが入るとのこと。<br/>
…が、Debian squeezeではパッケージが見つかりません…！</p>

<h3>unstableについて</h3>

<p>パッケージ作るためにはDebian unstableが必要で、これはどうやらディストリビューションのtrunkバージョンのようなものに当たるようです。<br/>
どうりでISOイメージが提供されていないはずです…。</p>

<p>ということでDebian squeezeをunstableにする方法を教えていただきました。<br/>
ちなみにunstableのコードネームは常にsidだそうで、これはtoystoryのワルガキに由来するそうです。</p>

<p><code>sources.list</code> に下記の2行だけ書いて、他の行をコメントアウトします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-squeeze:~# cat /etc/apt/sources.list
</span><span class='line'>...
</span><span class='line'>deb http://ftp.jaist.ac.jp/pub/Linux/Debian/ sid main
</span><span class='line'>deb-src http://ftp.jaist.ac.jp/pub/Linux/Debian/ sid main
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p>アップグレードします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-squeeze:~# apt-get update
</span><span class='line'>root@debian-squeeze:~# apt-get upgrade
</span><span class='line'>root@debian-squeeze:~# apt-get dist-upgrade</span></code></pre></td></tr></table></div></figure>


<p>ついでにホスト名も変えました。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat /etc/hostname 
</span><span class='line'>debian-sid</span></code></pre></td></tr></table></div></figure>


<p>sidにアップグレードしたら、無事 <code>packaging-dev</code> がインストールできました！</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-cache search packaging-dev
</span><span class='line'>packaging-dev - パッケージ開発のための便利なツール群
</span><span class='line'>root@debian-sid:~# apt-get install packaging-dev</span></code></pre></td></tr></table></div></figure>


<h2>サンプルパッケージ作成</h2>

<p>Debian unstable環境ができたので、周りの皆様に遅れながらも <a href="https://twitter.com/iwamatsu">@iwamatsu</a> 先生が用意してくださったサンプルパッケージをパッケージングします。</p>

<h3>まずビルドしてみる</h3>

<p>tarballを取得して展開します。<br/>
<em>※なお、tarballのダウンロードURLは、永続的なものか分からなかったため仮のものに置き換えています。</em></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~# mkdir -p ~/debian/dojo/work
</span><span class='line'>root@debian-sid:~# cd ~/debian/dojo/work/
</span><span class='line'>root@debian-sid:~/debian/dojo/work# wget http://experiments.example.com/hello-cwidget-20120922.tar.gz
</span><span class='line'>root@debian-sid:~/debian/dojo/work# tar xvf hello-cwidget-20120922.tar.gz 
</span><span class='line'>hello-cwidget-20120922/
</span><span class='line'>hello-cwidget-20120922/README
</span><span class='line'>hello-cwidget-20120922/config.h.in
</span><span class='line'>hello-cwidget-20120922/COPYING
</span><span class='line'>hello-cwidget-20120922/NEWS
</span><span class='line'>hello-cwidget-20120922/NOTE
</span><span class='line'>hello-cwidget-20120922/Makefile.in
</span><span class='line'>hello-cwidget-20120922/install-sh
</span><span class='line'>hello-cwidget-20120922/Makefile.am
</span><span class='line'>hello-cwidget-20120922/depcomp
</span><span class='line'>hello-cwidget-20120922/missing
</span><span class='line'>hello-cwidget-20120922/configure.in
</span><span class='line'>hello-cwidget-20120922/AUTHORS
</span><span class='line'>hello-cwidget-20120922/configure
</span><span class='line'>hello-cwidget-20120922/INSTALL
</span><span class='line'>hello-cwidget-20120922/hello-cwidget.cc
</span><span class='line'>hello-cwidget-20120922/autoscan.log
</span><span class='line'>hello-cwidget-20120922/ChangeLog
</span><span class='line'>hello-cwidget-20120922/aclocal.m4</span></code></pre></td></tr></table></div></figure>


<p>続いてconfigureしてみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work# cd hello-cwidget-20120922/
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ./configure 
</span><span class='line'>checking for a BSD-compatible install... /usr/bin/install -c
</span><span class='line'>checking whether build environment is sane... yes
</span><span class='line'>checking for a thread-safe mkdir -p... /bin/mkdir -p
</span><span class='line'>checking for gawk... no
</span><span class='line'>checking for mawk... mawk
</span><span class='line'>checking whether make sets $(MAKE)... yes
</span><span class='line'>checking for gcc... gcc
</span><span class='line'>checking whether the C compiler works... yes
</span><span class='line'>checking for C compiler default output file name... a.out
</span><span class='line'>checking for suffix of executables... 
</span><span class='line'>checking whether we are cross compiling... no
</span><span class='line'>checking for suffix of object files... o
</span><span class='line'>checking whether we are using the GNU C compiler... yes
</span><span class='line'>checking whether gcc accepts -g... yes
</span><span class='line'>checking for gcc option to accept ISO C89... none needed
</span><span class='line'>checking for style of include used by make... GNU
</span><span class='line'>checking dependency style of gcc... gcc3
</span><span class='line'>checking for g++... g++
</span><span class='line'>checking whether we are using the GNU C++ compiler... yes
</span><span class='line'>checking whether g++ accepts -g... yes
</span><span class='line'>checking dependency style of g++... gcc3
</span><span class='line'>checking for pkg-config... no
</span><span class='line'>checking for SIGC... no
</span><span class='line'>configure: error: in `/root/debian/dojo/work/hello-cwidget-20120922':
</span><span class='line'>configure: error: The pkg-config script could not be found or is too old.  Make sure it
</span><span class='line'>is in your PATH or set the PKG_CONFIG environment variable to the full
</span><span class='line'>path to pkg-config.
</span><span class='line'>
</span><span class='line'>Alternatively, you may set the environment variables SIGC_CFLAGS
</span><span class='line'>and SIGC_LIBS to avoid the need to call pkg-config.
</span><span class='line'>See the pkg-config man page for more details.
</span><span class='line'>
</span><span class='line'>To get pkg-config, see &lt;http://pkg-config.freedesktop.org/&gt;.
</span><span class='line'>See `config.log' for more details</span></code></pre></td></tr></table></div></figure>


<p><code>pkg-config</code> が足りないと言われてしまいました。<br/>
<code>pkg-config</code> が含まれるパッケージを探してインストールします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-file search pkg-config
</span><span class='line'>...
</span><span class='line'>pkg-config: /usr/bin/pkg-config
</span><span class='line'>
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-get install pkg-config</span></code></pre></td></tr></table></div></figure>


<p>再度configureします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ./configure
</span><span class='line'>...
</span><span class='line'>checking for pkg-config... /usr/bin/pkg-config
</span><span class='line'>checking pkg-config is at least version 0.9.0... yes
</span><span class='line'>checking for SIGC... no
</span><span class='line'>configure: error: Package requirements (sigc++-2.0) were not met:
</span><span class='line'>
</span><span class='line'>No package 'sigc++-2.0' found
</span><span class='line'>
</span><span class='line'>Consider adjusting the PKG_CONFIG_PATH environment variable if you
</span><span class='line'>installed software in a non-standard prefix.
</span><span class='line'>
</span><span class='line'>Alternatively, you may set the environment variables SIGC_CFLAGS
</span><span class='line'>and SIGC_LIBS to avoid the need to call pkg-config.
</span><span class='line'>See the pkg-config man page for more details.</span></code></pre></td></tr></table></div></figure>


<p>今度は<code>sigc++-2.0</code>が足りないようです。<br/>
<code>sigc++-2.0</code>が含まれるパッケージを探してインストールします。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-file search sigc++-2.0 | more
</span><span class='line'>libsigc++-2.0-0c2a: /usr/share/doc/libsigc++-2.0-0c2a/changelog.Debian.gz
</span><span class='line'>libsigc++-2.0-0c2a: /usr/share/doc/libsigc++-2.0-0c2a/changelog.gz
</span><span class='line'>libsigc++-2.0-0c2a: /usr/share/doc/libsigc++-2.0-0c2a/copyright
</span><span class='line'>libsigc++-2.0-dev: /usr/include/sigc++-2.0/sigc++/adaptors/adaptor_trait.h
</span><span class='line'>libsigc++-2.0-dev: /usr/include/sigc++-2.0/sigc++/adaptors/adaptors.h
</span><span class='line'>...
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-get install libsigc++-2.0-dev</span></code></pre></td></tr></table></div></figure>


<p>再度（ry</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ./configure 
</span><span class='line'>checking for SIGC... yes
</span><span class='line'>checking for CWIDGET... no
</span><span class='line'>configure: error: Package requirements (cwidget) were not met:
</span><span class='line'>
</span><span class='line'>No package 'cwidget' found
</span><span class='line'>
</span><span class='line'>Consider adjusting the PKG_CONFIG_PATH environment variable if you
</span><span class='line'>installed software in a non-standard prefix.
</span><span class='line'>
</span><span class='line'>Alternatively, you may set the environment variables CWIDGET_CFLAGS
</span><span class='line'>and CWIDGET_LIBS to avoid the need to call pkg-config.
</span><span class='line'>See the pkg-config man page for more details.</span></code></pre></td></tr></table></div></figure>


<p>こんどは<code>cwidget</code>が（ry<br/>
めんどくさくなったのでパッケージ名だけ表示して当たりをつけてみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-file search cwidget | cut -d ' ' -f 1 | sort -u
</span><span class='line'>chirp:
</span><span class='line'>d-rats:
</span><span class='line'>evolution-dev:
</span><span class='line'>libcwidget-dev:
</span><span class='line'>libcwidget-doc:
</span><span class='line'>libcwidget3-dbg:
</span><span class='line'>libcwidget3:
</span><span class='line'>libevolution:
</span><span class='line'>libmac-widgets-doc:
</span><span class='line'>qt4-doc-html:
</span><span class='line'>zabbix-frontend-php:
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-get install libcwidget-dev</span></code></pre></td></tr></table></div></figure>


<p>こんどこそ！</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ./configure
</span><span class='line'>...
</span><span class='line'>checking for pkg-config... /usr/bin/pkg-config
</span><span class='line'>checking pkg-config is at least version 0.9.0... yes
</span><span class='line'>checking for SIGC... yes
</span><span class='line'>checking for CWIDGET... yes
</span><span class='line'>configure: creating ./config.status
</span><span class='line'>config.status: creating config.h
</span><span class='line'>config.status: executing depfiles commands
</span><span class='line'>configure: creating ./config.status
</span><span class='line'>config.status: creating Makefile
</span><span class='line'>config.status: creating config.h
</span><span class='line'>config.status: config.h is unchanged
</span><span class='line'>config.status: executing depfiles commands
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# make
</span><span class='line'>make  all-am
</span><span class='line'>make[1]: ディレクトリ `/root/debian/dojo/work/hello-cwidget-20120922' に入ります
</span><span class='line'>make[1]: ディレクトリ `/root/debian/dojo/work/hello-cwidget-20120922' から出ます
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ./hello-cwidget </span></code></pre></td></tr></table></div></figure>


<p>やっとconfigure成功です！</p>

<h3>パッケージにしてみる</h3>

<p>configureまでできることを確認したところで、今回はmakeを端折ってパッケージングします。<br/>
もちろん本来はmakeしてプログラム単体での動作確認を行うべきでしょうが、この時点でかなり遅れてたので省いてしまいました。</p>

<p>まず、tarballを展開し直します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cd ..
</span><span class='line'>root@debian-sid:~/debian/dojo/work# rm -rf hello-cwidget-20120922
</span><span class='line'>root@debian-sid:~/debian/dojo/work# tar xvf hello-cwidget-20120922.tar.gz 
</span><span class='line'>root@debian-sid:~/debian/dojo/work# cd hello-cwidget-20120922/</span></code></pre></td></tr></table></div></figure>


<p><code>dh-make</code>を入れます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# apt-get install dh-make</span></code></pre></td></tr></table></div></figure>


<p><code>dh-make</code>を実行します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# dh_make --createorig -s
</span><span class='line'>Maintainer name  : root
</span><span class='line'>Email-Address    : root@debian-squeeze.mobile.mazgi.com 
</span><span class='line'>Date             : Sat, 22 Sep 2012 11:53:58 +0900
</span><span class='line'>Package Name     : hello-cwidget
</span><span class='line'>Version          : 20120922
</span><span class='line'>License          : blank
</span><span class='line'>Type of Package  : Single
</span><span class='line'>Hit &lt;enter&gt; to confirm: ^C</span></code></pre></td></tr></table></div></figure>


<p>すると…なんということでしょう！<br/>
メンテナ名とメールアドレスがめちゃくちゃではないですか!!</p>

<p>慌てて<code>DEBFULLNAME</code>と<code>DEBEMAIL</code>を設定します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# export DEBFULLNAME="Hidenori MATSUKI"
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# export DEBEMAIL="MATSUKI.Hidenori@gmail.com"
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# dh_make --createorig -s
</span><span class='line'>Maintainer name  : Hidenori MATSUKI
</span><span class='line'>Email-Address    : MATSUKI.Hidenori@gmail.com 
</span><span class='line'>Date             : Sat, 22 Sep 2012 11:56:51 +0900
</span><span class='line'>Package Name     : hello-cwidget
</span><span class='line'>Version          : 20120922
</span><span class='line'>License          : blank
</span><span class='line'>Type of Package  : Single
</span><span class='line'>Hit &lt;enter&gt; to confirm: 
</span><span class='line'>Done. Please edit the files in the debian/ subdirectory now. hello-cwidget
</span><span class='line'>uses a configure script, so you probably don't have to edit the Makefiles.</span></code></pre></td></tr></table></div></figure>


<p><code>dh_make</code> を実行するとdebianディレクトリが作成されるようです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# tree 
</span><span class='line'>.
</span><span class='line'>├── AUTHORS
</span><span class='line'>...
</span><span class='line'>├── configure.in
</span><span class='line'>├── debian
</span><span class='line'>│   ├── README.Debian
</span><span class='line'>│   ├── README.source
</span><span class='line'>│   ├── changelog
</span><span class='line'>│   ├── compat
</span><span class='line'>│   ├── control
</span><span class='line'>│   ├── copyright
</span><span class='line'>│   ├── docs
</span><span class='line'>│   ├── emacsen-install.ex
</span><span class='line'>│   ├── emacsen-remove.ex
</span><span class='line'>│   ├── emacsen-startup.ex
</span><span class='line'>│   ├── hello-cwidget.cron.d.ex
</span><span class='line'>│   ├── hello-cwidget.default.ex
</span><span class='line'>│   ├── hello-cwidget.doc-base.EX
</span><span class='line'>│   ├── init.d.ex
</span><span class='line'>│   ├── manpage.1.ex
</span><span class='line'>│   ├── manpage.sgml.ex
</span><span class='line'>│   ├── manpage.xml.ex
</span><span class='line'>│   ├── menu.ex
</span><span class='line'>│   ├── postinst.ex
</span><span class='line'>│   ├── postrm.ex
</span><span class='line'>│   ├── preinst.ex
</span><span class='line'>│   ├── prerm.ex
</span><span class='line'>│   ├── rules
</span><span class='line'>│   ├── source
</span><span class='line'>│   │   └── format
</span><span class='line'>│   └── watch.ex
</span><span class='line'>├── depcomp
</span><span class='line'>…
</span><span class='line'>
</span><span class='line'>2 directories, 43 files</span></code></pre></td></tr></table></div></figure>


<p>debianディレクトリ内のファイルで、今回パッケージを作成するにあたって不要なものを削除します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# rm debian/*.ex debian/*.EX debian/README.Debian debian/README.source debian/docs
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# tree 
</span><span class='line'>.
</span><span class='line'>├── AUTHORS
</span><span class='line'>…
</span><span class='line'>├── configure.in
</span><span class='line'>├── debian
</span><span class='line'>│   ├── changelog
</span><span class='line'>│   ├── compat
</span><span class='line'>│   ├── control
</span><span class='line'>│   ├── copyright
</span><span class='line'>│   ├── rules
</span><span class='line'>│   └── source
</span><span class='line'>│       └── format
</span><span class='line'>├── depcomp
</span><span class='line'>…
</span><span class='line'>
</span><span class='line'>2 directories, 24 files
</span></code></pre></td></tr></table></div></figure>


<p>開発環境では <code>debi</code> コマンドでインストールできるようですので、インストールして実行してみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# debi 
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# which hello-cwidget 
</span><span class='line'>/usr/bin/hello-cwidget
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# hello-cwidget </span></code></pre></td></tr></table></div></figure>


<p><img src="http://mazgi.github.com/images/2012-09-22-debian-dojo/20120922_hello-cwidget_01.png"></p>

<p>無事実行できました！</p>

<h4><em>dh_makeのオプションについて</em></h4>

<p>各オプションの意味を<code>man dh_make</code>でみるとそれぞれ下記の意味を持つようです。<br/>
<code>-s</code> は単体のプログラム用、</p>

<blockquote><p>-s, &#8211;single<br/>
Automatically set the package class to Single binary, skipping the question.</p></blockquote>

<p><code>--createorig</code> はオリジナルをtarballとして保存してくれる。</p>

<blockquote><p>If no -f is supplied either but &#8211;createorig is, the current  directory  is  created into  a news archive ../<packagename>-<version>.orig.tar.gz The original archive is needed for other Debian tools to generate the diffs to the original</p></blockquote>

<h2>パッケージのビルドテスト</h2>

<p><code>pbuilder</code> というツールを使うと、chroot環境のsandbox上でパッケージのビルドを検証できるようです。<br/>
このツールを使って、今回は特に依存パッケージのインストールをテストします。</p>

<p>早速設定ファイルを編集してchroot環境で使うシステムイメージを作ります。<br/>
今回は <code>cowbuilder</code> というものを使います。CopyOnWriteで早いらしいですよくわかりません！</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cat ~/.pbuilderrc 
</span><span class='line'>PDEBUILD_PBUILDER=cowbuilder
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cowbuilder --create</span></code></pre></td></tr></table></div></figure>


<p>そして <code>pdebuild</code> コマンドでビルドテストを行います。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cat debian/control 
</span><span class='line'>...
</span><span class='line'>Build-Depends: debhelper (&gt;= 9.0.0)
</span><span class='line'>...
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# pdebuild 
</span><span class='line'>...
</span><span class='line'>dh clean  --with autotools-dev
</span><span class='line'>dh: unable to load addon autotools-dev: Can't locate Debian/Debhelper/Sequence/autotools_dev.pm in @INC (@INC contains: /etc/perl /usr/local/lib/perl/5.14.2 /usr/local/share/perl/5.14.2 /usr/lib/perl5 /usr/share/perl5 /usr/lib/perl/5.14 /usr/share/perl/5.14 /usr/local/lib/site_perl .) at (eval 3) line 2.
</span><span class='line'>BEGIN failed--compilation aborted at (eval 3) line 2.
</span><span class='line'>
</span><span class='line'>make: *** [clean] Error 2
</span><span class='line'>dpkg-buildpackage: error: fakeroot debian/rules clean gave error exit status 2
</span><span class='line'>E: Failed autobuilding of package
</span><span class='line'>…</span></code></pre></td></tr></table></div></figure>


<p>見覚えのあるエラーでコケました。<br/>
<code>debian/control</code> ファイルに依存関係を追加して再度ビルドテストしてみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cat debian/control 
</span><span class='line'>...
</span><span class='line'>Build-Depends: debhelper (&gt;= 9.0.0), autotools-dev
</span><span class='line'>...
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# pdebuild 
</span><span class='line'>checking dependency style of g++... none
</span><span class='line'>checking for pkg-config... no
</span><span class='line'>checking for SIGC... no
</span><span class='line'>configure: error: in `/tmp/buildd/hello-cwidget-20120922':
</span><span class='line'>configure: error: The pkg-config script could not be found or is too old.  Make sure it
</span><span class='line'>is in your PATH or set the PKG_CONFIG environment variable to the full
</span><span class='line'>path to pkg-config.
</span><span class='line'>...
</span><span class='line'>configure: exit 1
</span><span class='line'>dh_auto_configure: ./configure --build=x86_64-linux-gnu --prefix=/usr --includedir=${prefix}/include --mandir=${prefix}/share/man --infodir=${prefix}/share/info --sysconfdir=/etc --localstatedir=/var --libexecdir=${prefix}/lib/hello-cwidget --disable-maintainer-mode --disable-dependency-tracking returned exit code 1
</span><span class='line'>make: *** [build] Error 25
</span><span class='line'>dpkg-buildpackage: error: debian/rules build gave error exit status 2
</span><span class='line'>E: Failed autobuilding of package
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p><code>debian/control</code> ファイルに依存関係を追加して（ry</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cat debian/control 
</span><span class='line'>...
</span><span class='line'>Build-Depends: debhelper (&gt;= 9.0.0), autotools-dev, libcwidget-dev
</span><span class='line'>...
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# pdebuild </span></code></pre></td></tr></table></div></figure>


<p>成功しました！<br/>
これでインストール時に依存パッケージも入れてくれるようになりました。</p>

<h2>パッケージビルド</h2>

<p>では改めて <code>debuild</code> コマンドでパッケージをビルドします。<br/>
オプションの <code>-us</code> はソースパッケージにPGP署名を行わない、 <code>-uc</code> は.changesファイルにPGP署名を行わないという意味になるようです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# debuild -us -uc</span></code></pre></td></tr></table></div></figure>


<p>1つ上のディレクトリを見てみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ls -l ..
</span><span class='line'>合計 208
</span><span class='line'>drwxr-xr-x 3 mazgi mazgi  4096  9月 22 14:24 hello-cwidget-20120922
</span><span class='line'>-rw-r--r-- 1 root  root  84299  9月 22 09:38 hello-cwidget-20120922.tar.gz
</span><span class='line'>-rw-r--r-- 1 root  root   1779  9月 22 14:24 hello-cwidget_20120922-1.debian.tar.gz
</span><span class='line'>-rw-r--r-- 1 root  root    915  9月 22 14:24 hello-cwidget_20120922-1.dsc
</span><span class='line'>-rw-r--r-- 1 root  root   6616  9月 22 14:24 hello-cwidget_20120922-1_amd64.build
</span><span class='line'>-rw-r--r-- 1 root  root   1637  9月 22 14:24 hello-cwidget_20120922-1_amd64.changes
</span><span class='line'>-rw-r--r-- 1 root  root   7134  9月 22 14:24 hello-cwidget_20120922-1_amd64.deb
</span><span class='line'>-rw-r--r-- 1 root  root   1357  9月 22 14:18 hello-cwidget_20120922-1_source.changes
</span><span class='line'>-rw-r--r-- 1 root  root  84280  9月 22 11:57 hello-cwidget_20120922.orig.tar.gz</span></code></pre></td></tr></table></div></figure>


<p>無事debファイルができています。</p>

<h2>パッケージインストール／アンインストールテスト</h2>

<p><code>piuparts</code> というツールでインストールとアンインストールのテストができるようです。<br/>
パッケージビルドで使用した<code>pdebuild</code> と同じようにchrootしてsandboxを提供してくれるようです。</p>

<p><code>pbuilder</code> にはCopyOnWriteで高速動作する <code>cowbuilder</code> がありますが、 <code>piuparts</code> のCopyOnWrite版は目下開発中のようです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# piuparts -d unstable ../hello-cwidget_20120922-1_amd64.deb 
</span><span class='line'>…
</span><span class='line'>7m52.2s INFO: PASS: All tests.
</span><span class='line'>7m52.2s INFO: piuparts run ends.</span></code></pre></td></tr></table></div></figure>


<h2>パッケージの修正</h2>

<p>今回のサンプルパッケージには、大変ありがたいことにtypoが <em>用意されている</em> ので修正してみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# grep -r Debain
</span><span class='line'>hello-cwidget.cc:     dialogs::ok(L"Hello, Debain Dojo!",</span></code></pre></td></tr></table></div></figure>


<p>&#8220;Debain&#8221;を&#8221;Debian&#8221;に修正してみます。</p>

<h3>patchをつくる</h3>

<p>typoを修正して、 <code>dpkg-source --commit</code> コマンドでパッチを作ります。楽チンですね。</p>

<p><code>dpkg-source --commit</code> コマンドは元のtarballを基準としてパッチを作るようです。<br/>
gitでいうところの<code>git init</code> 的な操作はいらないのかな？と不思議だったのですが、教えていただきました。<br/>
Makefileの書き方次第ではパッチにゴミが混じることがあるようなので、 <code>debuild</code> コマンドでcleanしたり、 <code>debclean</code> コマンドを実行してお掃除した方がいいようです。<br/>
今回は <code>./debian/rules clean</code> しちゃいましたが、この辺りサッパリ理解してないので必要に迫られたら調べたいです。</p>

<p>また、パッケージ自体のバージョン管理にはSubversionのような集中リポジトリ型より分散型のVCSの方が相性良いとのことです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# ./debian/rules clean
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# vi hello-cwidget.cc 
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# EDITOR=vi dpkg-source --commit
</span><span class='line'>dpkg-source: info: local changes detected, the modified files are:
</span><span class='line'> hello-cwidget-20120922/hello-cwidget.cc
</span><span class='line'>Enter the desired patch name: fix typo
</span><span class='line'>…
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cat debian/patches/series 
</span><span class='line'>fix-typo</span></code></pre></td></tr></table></div></figure>


<p>patchの内容はこんな感じです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# cat debian/patches/fix-typo 
</span><span class='line'>Description: Fixed message in dialog
</span><span class='line'> This patch is fixed typo from Debain to Debian.
</span><span class='line'> .
</span><span class='line'> hello-cwidget (20120922-1) unstable; urgency=low
</span><span class='line'> .
</span><span class='line'>   * Initial release (Closes: #nnnn)  &lt;nnnn is the bug number of your ITP&gt;
</span><span class='line'>Author: Hidenori MATSUKI &lt;MATSUKI.Hidenori@gmail.com&gt;
</span><span class='line'>
</span><span class='line'>---
</span><span class='line'>The information above should follow the Patch Tagging Guidelines, please
</span><span class='line'>checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
</span><span class='line'>are templates for supplementary fields that you might want to add:
</span><span class='line'>
</span><span class='line'>Origin: Other
</span><span class='line'>Forwarded: not-needed
</span><span class='line'>Last-Update: 2012-09-22
</span><span class='line'>
</span><span class='line'>--- hello-cwidget-20120922.orig/hello-cwidget.cc
</span><span class='line'>+++ hello-cwidget-20120922/hello-cwidget.cc
</span><span class='line'>@@ -35,7 +35,7 @@ int main(int argc, char **argv)
</span><span class='line'>  toplevel::init();
</span><span class='line'> 
</span><span class='line'>  widgets::widget_ref dialog =
</span><span class='line'>-     dialogs::ok(L"Hello, Debain Dojo!",
</span><span class='line'>+     dialogs::ok(L"Hello, Debian Dojo!",
</span><span class='line'>          util::arg(sigc::ptr_fun(toplevel::exitmain)));
</span><span class='line'> 
</span><span class='line'>  toplevel::settoplevel(dialog);</span></code></pre></td></tr></table></div></figure>


<p>再度 <code>debuild</code> コマンドを実行します。<br/>
どうやら <code>dpkg-source</code> が実行されてパッチが当たるようです。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# debuild -us -uc
</span><span class='line'>…
</span><span class='line'>dpkg-source: info: applying fix-typo
</span><span class='line'>…
</span><span class='line'>Finished running lintian.</span></code></pre></td></tr></table></div></figure>


<p><code>debi</code> で更新されたパッケージをインストールしてみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# debi 
</span><span class='line'>(データベースを読み込んでいます ... 現在 61017 個のファイルとディレクトリがインストールされています。)
</span><span class='line'>hello-cwidget 20120922-1 を (hello-cwidget_20120922-1_amd64.deb で) 置換するための準備をしています ...
</span><span class='line'>hello-cwidget を展開し、置換しています...
</span><span class='line'>hello-cwidget (20120922-1) を設定しています ...
</span><span class='line'>root@debian-sid:~/debian/dojo/work/hello-cwidget-20120922# hello-cwidget </span></code></pre></td></tr></table></div></figure>


<p><img src="http://mazgi.github.com/images/2012-09-22-debian-dojo/20120922_hello-cwidget_02.png"></p>

<p>ちゃんと&#8221;Debain&#8221;が&#8221;Debian&#8221;に直っていますね！<br/>
どうやら <code>debi</code> コマンドでインストールすると同じバージョンのパッケージでも置き換えられるようです。</p>

<h1>Ruby1.9.3をパッケージングしてみる…</h1>

<p>さていよいよRuby1.9.3のパッケージングに挑戦です！<br/>
これが目的で参加させていただいたのでした。</p>

<p>まずはtarball持ってきてビルドできることを確認…</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@debian-sid:~/debian/dojo/work.ruby# pwd
</span><span class='line'>/root/debian/dojo/work.ruby
</span><span class='line'>root@debian-sid:~/debian/dojo/work.ruby# curl -LO ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p194.tar.bz2
</span><span class='line'>root@debian-sid:~/debian/dojo/work.ruby# tar xf ruby-1.9.3-p194.tar.bz2 
</span><span class='line'>root@debian-sid:~/debian/dojo/work.ruby# cd ruby-1.9.3-p194/
</span><span class='line'>root@debian-sid:~/debian/dojo/work.ruby/ruby-1.9.3-p194# ./configure 
</span><span class='line'>root@debian-sid:~/debian/dojo/work.ruby/ruby-1.9.3-p194# make
</span><span class='line'>root@debian-sid:~/debian/dojo/work.ruby/ruby-1.9.3-p194# make check</span></code></pre></td></tr></table></div></figure>


<p>…してたら <code>make check</code> 終わらずに時間切れ。</p>

<p>今回ここまででした。。</p>

<h1>感想と教えていただいたこと</h1>

<p>成果発表の時間に&#8221;前に立って質問する&#8221;という前代未聞の方法でいろいろ教えていただいたのでメモ。</p>

<ul>
<li>感じたDebian文化

<ul>
<li>「それはFreeじゃない」とか聴こえてきてさすがDebian GNU/Linuxだなと思いました。</li>
<li>(Debianに限らないけど)対象のライセンスは皆さんものすごく気にされてて「見習わないと！」と思いました。</li>
</ul>
</li>
<li>Rubyパッケージについて

<ul>
<li><a href="http://packages.debian.org/ja/sid/libruby">libruby</a>あるそうです！…ｏｒｚ</li>
<li>「rubyをビルドするなら、debian用のtarball使ったほうが楽だよ！」と教えていただきました、感謝。</li>
</ul>
</li>
<li>mikutterパッケージ作った方が！ <a href="https://github.com/upsilon/mikutter-deb">upsilon/mikutter-deb</a>

<ul>
<li>Debianコミュニティでもパッケージング中とのこと</li>
<li>アイコンは&#8221;みく&#8221;だそうです、なんだー初音ミクとは無関係なんですねー当たり前ですねっ</li>
<li>画像のライセンスはCC by SA3.0とのこと</li>
<li>音源もライセンス解決したorする見込みだそうです。</li>
<li>ライセンス問題全部解決したので晴れてパッケージになる！らしいです。</li>
</ul>
</li>
<li>PHPにも<a href="http://getcomposer.org/">Composer</a>というRubyのbundlerぽいのがあるらしいです、知らなかった。</li>
</ul>


<p>環境構築で手間取って聞き漏らしたり理解しきれなかったところも多いのですが、debファイルがちょっとだけ身近に感じられるようになりました。
皆さん本当にありがとうございました！</p>
]]></content>
  </entry>
  
</feed>
